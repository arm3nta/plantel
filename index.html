<!-- Agregamos una nueva ventana para editar -->
<div id="ventanaModificar" class="seccion ventana" style="background-color: #fefefe; border-left: 5px solid #0077cc; padding: 20px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
  <h3 style="color: #0077cc; font-size: 1.4rem; margin-bottom: 20px;">Modificar Plantel</h3>
  
  <label style="display:block; font-weight:bold; margin-bottom:5px;">Documentos Faltantes</label>
  <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 10px; margin-bottom: 20px;">
    <label><input type="checkbox" class="mod-checkbox" value="ACTUALIZACIÓN DE DATOS"> ACTUALIZACIÓN DE DATOS</label>
    <label><input type="checkbox" class="mod-checkbox" value="OFERTA EDUCATIVA"> OFERTA EDUCATIVA</label>
    <label><input type="checkbox" class="mod-checkbox" value="LISTADO DE CARRERAS"> LISTADO DE CARRERAS</label>
    <label><input type="checkbox" class="mod-checkbox" value="CONTRATO DE ARRENDAMIENTO"> CONTRATO DE ARRENDAMIENTO</label>
    <label><input type="checkbox" class="mod-checkbox" value="RVOE ACTUALIZADO"> RVOE ACTUALIZADO</label>
    <label><input type="checkbox" class="mod-checkbox" value="CCT"> CCT</label>
    <label><input type="checkbox" class="mod-checkbox" value="COMPROBANTE DE DOMICILIO"> COMPROBANTE DE DOMICILIO</label>
    <label><input type="checkbox" class="mod-checkbox" value="INFORME FOTOGRÁFICO"> INFORME FOTOGRÁFICO</label>
  </div>

  <label style="display:block; font-weight:bold; margin-bottom:5px;">Anotaciones</label>
  <textarea id="modAnotaciones" rows="4" placeholder="Modifica anotaciones..." style="width:100%; padding:10px; border:1px solid #ccc; border-radius:5px; resize: vertical; margin-bottom: 20px;"></textarea>

  <div class="botones-row" style="display: flex; gap: 10px;">
    <button onclick="guardarModificacion()">Guardar Cambios</button>
    <button onclick="mostrarVentana(null)" style="background-color: #ccc; color: #333;">Cancelar</button>
  </div>
</div>

<script type="module">
  // Código Firebase igual...
  let idPlantelAModificar = null;

  globalThis.modificarPlantel = async (id) => {
    idPlantelAModificar = id;
    const docSnap = await getDocs(collection(db, "planteles"));
    const datos = docSnap.docs.find(d => d.id === id).data();

    // Set checkboxes y anotaciones
    document.querySelectorAll('.mod-checkbox').forEach(cb => {
      cb.checked = datos.documentos?.includes(cb.value) || false;
    });
    document.getElementById("modAnotaciones").value = datos.anotaciones || "";
    mostrarVentana('ventanaModificar');
  };

  globalThis.guardarModificacion = async () => {
    const checks = document.querySelectorAll('.mod-checkbox:checked');
    const documentos = Array.from(checks).map(c => c.value);
    const anotaciones = document.getElementById("modAnotaciones").value;

    await updateDoc(doc(db, "planteles", idPlantelAModificar), {
      documentos,
      anotaciones
    });

    alert("Plantel modificado");
    mostrarVentana(null);
    buscarPlantel();
  };
</script>
